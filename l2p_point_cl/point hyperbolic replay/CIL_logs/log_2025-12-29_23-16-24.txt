Label Remap Created: {8: 0, 30: 1, 0: 2, 4: 3, 2: 4, 37: 5, 22: 6, 33: 7, 35: 8, 5: 9, 21: 10, 36: 11, 26: 12, 25: 13, 7: 14, 12: 15, 14: 16, 23: 17, 16: 18, 17: 19, 28: 20, 3: 21, 9: 22, 34: 23, 15: 24, 20: 25, 18: 26, 11: 27, 1: 28, 29: 29, 19: 30, 31: 31, 13: 32, 27: 33, 39: 34, 32: 35, 24: 36, 38: 37, 10: 38, 6: 39}
Using L2P_PointMLP with Pre-trained Weights...
Loading PointMLP weights from e:\非全相关\毕业论文\point_l2p\classification_ScanObjectNN\pointMLP-demo1\best_checkpoint.pth
Weight Load Message: <All keys matched successfully>

==================== Task 0 ====================
Training on Categories: ['chair', 'sofa']
Validating on Categories: ['chair', 'sofa']
The size of train data is 9843
The size of test data is 2468
Initializing Prompts for Task 0 using Data Centroids...
 Assigning Centroid to Prompts [0:3]
<================== L2P Task 0 Training ===================>
<=== Epoch: 0 | Loss: 6.4827 | Val Acc (Linear): 0.9600 | Time: 28.39s ===>
<=== Epoch: 1 | Loss: 1.8553 | Val Acc (Linear): 0.9700 | Time: 26.72s ===>
<=== Epoch: 2 | Loss: 1.8464 | Val Acc (Linear): 0.9650 | Time: 26.25s ===>
<=== Epoch: 3 | Loss: 1.8259 | Val Acc (Linear): 0.9550 | Time: 26.72s ===>
<=== Epoch: 4 | Loss: 1.7930 | Val Acc (Linear): 0.9850 | Time: 26.84s ===>
<=== Epoch: 5 | Loss: 1.8545 | Val Acc (Linear): 0.8750 | Time: 27.08s ===>
<=== Epoch: 6 | Loss: 2.1375 | Val Acc (Linear): 0.9800 | Time: 27.97s ===>
<=== Epoch: 7 | Loss: 2.0201 | Val Acc (Linear): 0.9850 | Time: 27.05s ===>
<=== Epoch: 8 | Loss: 1.8539 | Val Acc (Linear): 0.9250 | Time: 27.32s ===>
<=== Epoch: 9 | Loss: 2.0860 | Val Acc (Linear): 0.9850 | Time: 26.97s ===>
<=== Epoch: 10 | Loss: 1.7227 | Val Acc (Linear): 0.9850 | Time: 28.03s ===>
<=== Epoch: 11 | Loss: 1.7412 | Val Acc (Linear): 0.9900 | Time: 27.40s ===>
<=== Epoch: 12 | Loss: 1.7302 | Val Acc (Linear): 0.9300 | Time: 28.53s ===>
<=== Epoch: 13 | Loss: 1.7462 | Val Acc (Linear): 0.9850 | Time: 28.27s ===>
<=== Epoch: 14 | Loss: 1.8147 | Val Acc (Linear): 0.9850 | Time: 27.81s ===>
<=== Epoch: 15 | Loss: 1.6914 | Val Acc (Linear): 0.9700 | Time: 27.77s ===>
<=== Epoch: 16 | Loss: 2.0254 | Val Acc (Linear): 0.9850 | Time: 27.26s ===>
<=== Epoch: 17 | Loss: 1.7179 | Val Acc (Linear): 0.9500 | Time: 27.47s ===>
<=== Epoch: 18 | Loss: 1.7197 | Val Acc (Linear): 0.9700 | Time: 28.18s ===>
<=== Epoch: 19 | Loss: 1.8519 | Val Acc (Linear): 0.9800 | Time: 28.49s ===>
<=== Epoch: 20 | Loss: 1.6971 | Val Acc (Linear): 0.9850 | Time: 28.40s ===>
<=== Epoch: 21 | Loss: 2.0798 | Val Acc (Linear): 0.9850 | Time: 28.27s ===>
<=== Epoch: 22 | Loss: 1.7771 | Val Acc (Linear): 0.9850 | Time: 28.00s ===>
<=== Epoch: 23 | Loss: 3.4598 | Val Acc (Linear): 0.9800 | Time: 28.08s ===>
<=== Epoch: 24 | Loss: 2.1062 | Val Acc (Linear): 0.9850 | Time: 27.99s ===>
<=== Epoch: 25 | Loss: 1.7194 | Val Acc (Linear): 0.9850 | Time: 27.41s ===>
<=== Epoch: 26 | Loss: 1.7310 | Val Acc (Linear): 0.9850 | Time: 28.21s ===>
<=== Epoch: 27 | Loss: 1.8124 | Val Acc (Linear): 0.9800 | Time: 27.91s ===>
<=== Epoch: 28 | Loss: 1.7278 | Val Acc (Linear): 0.9850 | Time: 28.21s ===>
<=== Epoch: 29 | Loss: 1.7200 | Val Acc (Linear): 0.9900 | Time: 28.08s ===>
Task 0 Training Completed.
Computing Prototypes (NCM) for current task...
 Task 0 Centroid saved.
Prototypes updated. Total classes stored: 2
Validating with Task-Gated NCM...
 Using Task-Gated Inference with 1 task centroids.
NCM Accuracy: 0.9600
Task 0 Final CIL Accuracy (NCM): 0.9600
Task 0 Linear Head Accuracy (For Reference): 0.9900

==================== Task 1 ====================
Training on Categories: ['airplane', 'bookshelf']
Validating on Categories: ['chair', 'sofa', 'airplane', 'bookshelf']
The size of train data is 9843
The size of test data is 2468
Initializing Prompts for Task 1 using Data Centroids...
 Assigning Centroid to Prompts [3:6]
<================== L2P Task 1 Training ===================>
<=== Epoch: 0 | Loss: 3.2460 | Val Acc (Linear): 0.5000 | Time: 22.24s ===>
<=== Epoch: 1 | Loss: 1.7234 | Val Acc (Linear): 0.5000 | Time: 21.10s ===>
<=== Epoch: 2 | Loss: 1.6964 | Val Acc (Linear): 0.5000 | Time: 20.58s ===>
<=== Epoch: 3 | Loss: 1.6652 | Val Acc (Linear): 0.5000 | Time: 21.65s ===>
<=== Epoch: 4 | Loss: 1.6985 | Val Acc (Linear): 0.5000 | Time: 21.78s ===>
<=== Epoch: 5 | Loss: 1.6713 | Val Acc (Linear): 0.5000 | Time: 21.45s ===>
<=== Epoch: 6 | Loss: 1.6636 | Val Acc (Linear): 0.5000 | Time: 23.33s ===>
<=== Epoch: 7 | Loss: 1.6636 | Val Acc (Linear): 0.5000 | Time: 21.28s ===>
<=== Epoch: 8 | Loss: 1.6636 | Val Acc (Linear): 0.5000 | Time: 21.51s ===>
<=== Epoch: 9 | Loss: 1.6636 | Val Acc (Linear): 0.5000 | Time: 21.05s ===>
<=== Epoch: 10 | Loss: 1.6636 | Val Acc (Linear): 0.5000 | Time: 21.28s ===>
<=== Epoch: 11 | Loss: 1.6636 | Val Acc (Linear): 0.5000 | Time: 21.37s ===>
<=== Epoch: 12 | Loss: 1.6637 | Val Acc (Linear): 0.5000 | Time: 20.91s ===>
<=== Epoch: 13 | Loss: 1.6636 | Val Acc (Linear): 0.5000 | Time: 21.72s ===>
<=== Epoch: 14 | Loss: 1.6636 | Val Acc (Linear): 0.5000 | Time: 20.99s ===>
<=== Epoch: 15 | Loss: 1.6636 | Val Acc (Linear): 0.5000 | Time: 20.99s ===>
<=== Epoch: 16 | Loss: 1.6637 | Val Acc (Linear): 0.5000 | Time: 22.61s ===>
<=== Epoch: 17 | Loss: 1.6639 | Val Acc (Linear): 0.4975 | Time: 21.57s ===>
<=== Epoch: 18 | Loss: 1.8921 | Val Acc (Linear): 0.5000 | Time: 21.46s ===>
<=== Epoch: 19 | Loss: 1.7696 | Val Acc (Linear): 0.5000 | Time: 20.82s ===>
<=== Epoch: 20 | Loss: 1.7678 | Val Acc (Linear): 0.5000 | Time: 21.23s ===>
<=== Epoch: 21 | Loss: 1.7263 | Val Acc (Linear): 0.5000 | Time: 20.87s ===>
<=== Epoch: 22 | Loss: 2.1024 | Val Acc (Linear): 0.5000 | Time: 21.27s ===>
<=== Epoch: 23 | Loss: 1.6640 | Val Acc (Linear): 0.5000 | Time: 21.22s ===>
<=== Epoch: 24 | Loss: 1.6777 | Val Acc (Linear): 0.5000 | Time: 21.79s ===>
<=== Epoch: 25 | Loss: 1.7261 | Val Acc (Linear): 0.5000 | Time: 20.87s ===>
<=== Epoch: 26 | Loss: 1.7295 | Val Acc (Linear): 0.5000 | Time: 21.67s ===>
<=== Epoch: 27 | Loss: 1.6636 | Val Acc (Linear): 0.5000 | Time: 21.67s ===>
<=== Epoch: 28 | Loss: 1.6636 | Val Acc (Linear): 0.5000 | Time: 22.38s ===>
<=== Epoch: 29 | Loss: 1.6636 | Val Acc (Linear): 0.5000 | Time: 22.04s ===>
Task 1 Training Completed.
Computing Prototypes (NCM) for current task...
 Task 1 Centroid saved.
Prototypes updated. Total classes stored: 4
Validating with Task-Gated NCM...
 Using Task-Gated Inference with 2 task centroids.
NCM Accuracy: 0.9475
Task 1 Final CIL Accuracy (NCM): 0.9475
Task 1 Linear Head Accuracy (For Reference): 0.5000

==================== Task 2 ====================
Training on Categories: ['bed', 'vase']
Validating on Categories: ['chair', 'sofa', 'airplane', 'bookshelf', 'bed', 'vase']
The size of train data is 9843
The size of test data is 2468
Initializing Prompts for Task 2 using Data Centroids...
 Assigning Centroid to Prompts [6:9]
<================== L2P Task 2 Training ===================>
<=== Epoch: 0 | Loss: 8.5050 | Val Acc (Linear): 0.3250 | Time: 18.88s ===>
<=== Epoch: 1 | Loss: 1.7009 | Val Acc (Linear): 0.3333 | Time: 19.01s ===>
<=== Epoch: 2 | Loss: 1.6840 | Val Acc (Linear): 0.3333 | Time: 17.92s ===>
<=== Epoch: 3 | Loss: 1.6657 | Val Acc (Linear): 0.3317 | Time: 18.60s ===>
<=== Epoch: 4 | Loss: 1.6814 | Val Acc (Linear): 0.3333 | Time: 18.86s ===>
<=== Epoch: 5 | Loss: 1.6658 | Val Acc (Linear): 0.3333 | Time: 19.23s ===>
<=== Epoch: 6 | Loss: 1.6637 | Val Acc (Linear): 0.3333 | Time: 19.09s ===>
<=== Epoch: 7 | Loss: 1.6636 | Val Acc (Linear): 0.3333 | Time: 18.85s ===>
<=== Epoch: 8 | Loss: 1.6636 | Val Acc (Linear): 0.3333 | Time: 18.80s ===>
<=== Epoch: 9 | Loss: 1.6636 | Val Acc (Linear): 0.3333 | Time: 18.80s ===>
<=== Epoch: 10 | Loss: 1.6636 | Val Acc (Linear): 0.3333 | Time: 19.01s ===>
<=== Epoch: 11 | Loss: 1.6724 | Val Acc (Linear): 0.3317 | Time: 19.24s ===>
<=== Epoch: 12 | Loss: 1.7647 | Val Acc (Linear): 0.3317 | Time: 19.49s ===>
<=== Epoch: 13 | Loss: 2.0986 | Val Acc (Linear): 0.3333 | Time: 18.33s ===>
<=== Epoch: 14 | Loss: 1.6636 | Val Acc (Linear): 0.3333 | Time: 19.32s ===>
<=== Epoch: 15 | Loss: 1.6974 | Val Acc (Linear): 0.3333 | Time: 18.98s ===>
<=== Epoch: 16 | Loss: 1.7295 | Val Acc (Linear): 0.3333 | Time: 18.41s ===>
<=== Epoch: 17 | Loss: 1.6708 | Val Acc (Linear): 0.3333 | Time: 18.91s ===>
<=== Epoch: 18 | Loss: 1.6636 | Val Acc (Linear): 0.3333 | Time: 18.89s ===>
<=== Epoch: 19 | Loss: 1.6636 | Val Acc (Linear): 0.3333 | Time: 19.34s ===>
<=== Epoch: 20 | Loss: 1.6636 | Val Acc (Linear): 0.3333 | Time: 18.27s ===>
<=== Epoch: 21 | Loss: 1.6636 | Val Acc (Linear): 0.3333 | Time: 19.08s ===>
<=== Epoch: 22 | Loss: 1.6636 | Val Acc (Linear): 0.3333 | Time: 18.51s ===>
<=== Epoch: 23 | Loss: 1.6636 | Val Acc (Linear): 0.3333 | Time: 17.78s ===>
<=== Epoch: 24 | Loss: 1.6636 | Val Acc (Linear): 0.3333 | Time: 18.73s ===>
<=== Epoch: 25 | Loss: 1.6636 | Val Acc (Linear): 0.3333 | Time: 19.46s ===>
<=== Epoch: 26 | Loss: 1.6636 | Val Acc (Linear): 0.3333 | Time: 19.49s ===>
<=== Epoch: 27 | Loss: 1.6636 | Val Acc (Linear): 0.3333 | Time: 19.08s ===>
<=== Epoch: 28 | Loss: 1.6636 | Val Acc (Linear): 0.3333 | Time: 19.48s ===>
<=== Epoch: 29 | Loss: 1.6636 | Val Acc (Linear): 0.3333 | Time: 18.76s ===>
Task 2 Training Completed.
Computing Prototypes (NCM) for current task...
 Task 2 Centroid saved.
Prototypes updated. Total classes stored: 6
Validating with Task-Gated NCM...
 Using Task-Gated Inference with 3 task centroids.
NCM Accuracy: 0.9033
Task 2 Final CIL Accuracy (NCM): 0.9033
Task 2 Linear Head Accuracy (For Reference): 0.3333

==================== Task 3 ====================
Training on Categories: ['monitor', 'table']
Validating on Categories: ['chair', 'sofa', 'airplane', 'bookshelf', 'bed', 'vase', 'monitor', 'table']
The size of train data is 9843
The size of test data is 2468
Initializing Prompts for Task 3 using Data Centroids...
 Assigning Centroid to Prompts [9:12]
<================== L2P Task 3 Training ===================>
<=== Epoch: 0 | Loss: 14.6497 | Val Acc (Linear): 0.2238 | Time: 16.57s ===>
<=== Epoch: 1 | Loss: 1.7431 | Val Acc (Linear): 0.2487 | Time: 16.43s ===>
<=== Epoch: 2 | Loss: 1.6757 | Val Acc (Linear): 0.2500 | Time: 16.79s ===>
<=== Epoch: 3 | Loss: 1.8767 | Val Acc (Linear): 0.2412 | Time: 16.61s ===>
<=== Epoch: 4 | Loss: 1.6989 | Val Acc (Linear): 0.2500 | Time: 17.40s ===>
<=== Epoch: 5 | Loss: 1.6636 | Val Acc (Linear): 0.2500 | Time: 16.57s ===>
<=== Epoch: 6 | Loss: 1.6636 | Val Acc (Linear): 0.2500 | Time: 16.96s ===>
<=== Epoch: 7 | Loss: 1.6638 | Val Acc (Linear): 0.2500 | Time: 17.79s ===>
<=== Epoch: 8 | Loss: 1.7046 | Val Acc (Linear): 0.2500 | Time: 18.02s ===>
<=== Epoch: 9 | Loss: 1.6641 | Val Acc (Linear): 0.2500 | Time: 17.25s ===>
<=== Epoch: 10 | Loss: 1.7602 | Val Acc (Linear): 0.2500 | Time: 17.36s ===>
<=== Epoch: 11 | Loss: 1.9745 | Val Acc (Linear): 0.2500 | Time: 16.43s ===>
<=== Epoch: 12 | Loss: 1.6840 | Val Acc (Linear): 0.2500 | Time: 17.01s ===>
<=== Epoch: 13 | Loss: 1.6687 | Val Acc (Linear): 0.2500 | Time: 16.56s ===>
<=== Epoch: 14 | Loss: 1.8110 | Val Acc (Linear): 0.2412 | Time: 16.66s ===>
<=== Epoch: 15 | Loss: 1.6843 | Val Acc (Linear): 0.2500 | Time: 16.81s ===>
<=== Epoch: 16 | Loss: 1.6636 | Val Acc (Linear): 0.2500 | Time: 16.57s ===>
<=== Epoch: 17 | Loss: 1.6636 | Val Acc (Linear): 0.2500 | Time: 16.94s ===>
<=== Epoch: 18 | Loss: 1.6636 | Val Acc (Linear): 0.2500 | Time: 17.42s ===>
<=== Epoch: 19 | Loss: 1.6636 | Val Acc (Linear): 0.2500 | Time: 16.90s ===>
<=== Epoch: 20 | Loss: 1.6636 | Val Acc (Linear): 0.2500 | Time: 17.31s ===>
<=== Epoch: 21 | Loss: 1.6636 | Val Acc (Linear): 0.2500 | Time: 17.09s ===>
<=== Epoch: 22 | Loss: 1.6636 | Val Acc (Linear): 0.2500 | Time: 16.75s ===>
<=== Epoch: 23 | Loss: 1.6636 | Val Acc (Linear): 0.2500 | Time: 17.03s ===>
<=== Epoch: 24 | Loss: 1.6636 | Val Acc (Linear): 0.2500 | Time: 16.38s ===>
<=== Epoch: 25 | Loss: 1.6636 | Val Acc (Linear): 0.2500 | Time: 17.06s ===>
<=== Epoch: 26 | Loss: 1.6636 | Val Acc (Linear): 0.2500 | Time: 17.43s ===>
<=== Epoch: 27 | Loss: 1.6636 | Val Acc (Linear): 0.2500 | Time: 18.59s ===>
<=== Epoch: 28 | Loss: 1.6636 | Val Acc (Linear): 0.2500 | Time: 16.49s ===>
<=== Epoch: 29 | Loss: 1.6636 | Val Acc (Linear): 0.2500 | Time: 16.74s ===>
Task 3 Training Completed.
Computing Prototypes (NCM) for current task...
 Task 3 Centroid saved.
Prototypes updated. Total classes stored: 8
Validating with Task-Gated NCM...
 Using Task-Gated Inference with 4 task centroids.
NCM Accuracy: 0.8612
Task 3 Final CIL Accuracy (NCM): 0.8612
Task 3 Linear Head Accuracy (For Reference): 0.2500

==================== Task 4 ====================
Training on Categories: ['toilet', 'bottle']
Validating on Categories: ['chair', 'sofa', 'airplane', 'bookshelf', 'bed', 'vase', 'monitor', 'table', 'toilet', 'bottle']
The size of train data is 9843
The size of test data is 2468
Initializing Prompts for Task 4 using Data Centroids...
 Assigning Centroid to Prompts [12:15]
<================== L2P Task 4 Training ===================>
